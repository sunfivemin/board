<!DOCTYPE html>
<html lang="ko">
  <head>
    <%- include('../partials/head') %>
    <title>ê²Œì‹œíŒ</title>
    <link rel="stylesheet" href="/css/main.css">  
    <script src="/js/nav.js" defer></script>   
  </head>
  <body>
    <%- include('../partials/nav') %>

    <div class="page-wrapper">
      <div class="container">
      <div class="search-container">
        <div class="search-wrapper">
          <input class="search" placeholder="ì œëª©, ë‚´ìš©, ì¹´í…Œê³ ë¦¬ë¡œ ê²€ìƒ‰..." id="searchInput">
          <button class="search-send" onclick="performSearch()">
            <span>ğŸ”</span>
            <span>ê²€ìƒ‰</span>
          </button>
        </div>
      </div>
      <div class="posts-container">
        <% posts.forEach(function(post, index) { %>
        <div class="post-item" onclick="location.href='/new/<%= post._id %>'">
          <div class="post-number"><%= posts.length - index %></div>
          <div class="post-category" data-category="<%= post.category || 'ê¸°ìˆ ìŠ¤íƒ' %>">
            <% if (post.category === 'ì¼ë°˜') { %>ê¸°ìˆ ìŠ¤íƒ
            <% } else if (post.category === 'ê³µì§€') { %>ë©´ì ‘ì¤€ë¹„
            <% } else if (post.category === 'ì§ˆë¬¸') { %>í•™ìŠµì¼ì§€
            <% } else { %><%= post.category || 'ê¸°ìˆ ìŠ¤íƒ' %><% } %>
          </div>
          <div class="post-title"><%= post.title %></div>
          <div class="post-date">
            <%= post.createdAt ? new
            Date(post.createdAt).toLocaleString('ko-KR', { year: 'numeric',
            month: 'long', day: 'numeric' }) : 'ë‚ ì§œ ì—†ìŒ' %>
          </div>
        </div>
        <% }); %>
      </div>

     <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
     <div class="pagination">
      <% if (totalPages > 1) { %>
        <!-- ì´ì „ í˜ì´ì§€ ë²„íŠ¼ -->
        <button 
          onclick="location.href='/new?page=<%= currentPage - 1 %>'"
          <%= currentPage === 1 ? 'disabled' : '' %>
        >ì´ì „</button>

        <!-- í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ë“¤ -->
        <% for(let i = 1; i <= totalPages; i++) { %>
          <button 
            onclick="location.href='/new?page=<%= i %>'"
            class="<%= currentPage === i ? 'active' : '' %>"
          ><%= i %></button>
        <% } %>

        <!-- ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼ -->
        <button 
          onclick="location.href='/new?page=<%= currentPage + 1 %>'"
          <%= currentPage === totalPages ? 'disabled' : '' %>
        >ë‹¤ìŒ</button>
      <% } %>
    </div>
    <% if (user) { %>
    <div class="write-btn-container">
      <button onclick="location.href='/new/write'" class="write-btn">
        ê¸€ì“°ê¸°
      </button>
    </div>
    <% } %>
      </div> <!-- container ë‹«ê¸° -->
    </div> <!-- page-wrapper ë‹«ê¸° -->

           <footer>
         <div class="footer-content">
           <div class="footer-section">
             <h3>SEONOH</h3>
             <p>ë§¤ì¼ ì„±ì¥í•˜ëŠ” ê°œë°œì ë˜ê¸°</p>
           </div>
           <div class="footer-section">
             <h4>Quick Links</h4>
             <ul>
               <li><a href="/new">ê²Œì‹œíŒ</a></li>
               <li><a href="/new/write">ê¸€ì“°ê¸°</a></li>
             </ul>
           </div>
           <div class="footer-section">
             <h4>Contact</h4>
             <p>ğŸ“§ sunfivemin@gmail.com</p>
             <p>ğŸ’» <a href="https://github.com/sunfivemin" target="_blank">GitHub</a></p>
           </div>
         </div>
         <div class="footer-bottom">
           <p>Â© 2025 SEONOH. Made with â¤ï¸ for developers</p>
         </div>
       </footer>

    <script src="/js/search.js" defer></script>
    
    <script>
      // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë©”ì‹œì§€ í™•ì¸
      const urlParams = new URLSearchParams(window.location.search);
      const message = urlParams.get('message');
      const type = urlParams.get('type');
      
      if (message) {
        if (type === 'success') {
          showModal(message, {
            title: 'ì„±ê³µ',
            type: 'success'
          });
        } else if (type === 'error') {
          showModal(message, {
            title: 'ì˜¤ë¥˜',
            type: 'error'
          });
        }
      }
    </script>
  </body>
</html>
