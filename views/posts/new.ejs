<!DOCTYPE html>
<html lang="ko">
  <head>
    <%- include('../partials/head') %>
    <title>게시판</title>
    <link rel="stylesheet" href="/css/main.css">  
    <script src="/js/nav.js" defer></script>   
  </head>
  <body>
    <%- include('../partials/nav') %>

    <div class="page-wrapper">
      <div class="container">
      <div class="search-container">
        <div class="search-wrapper">
          <input class="search" placeholder="제목, 내용, 카테고리로 검색..." id="searchInput">
          <button class="search-send" onclick="performSearch()">
            <span>🔍</span>
            <span>검색</span>
          </button>
        </div>
      </div>
      <div class="posts-container">
        <% posts.forEach(function(post, index) { %>
        <div class="post-item" onclick="location.href='/new/<%= post._id %>'">
          <div class="post-number"><%= posts.length - index %></div>
          <div class="post-category" data-category="<%= post.category || '기술스택' %>">
            <% if (post.category === '일반') { %>기술스택
            <% } else if (post.category === '공지') { %>면접준비
            <% } else if (post.category === '질문') { %>학습일지
            <% } else { %><%= post.category || '기술스택' %><% } %>
          </div>
          <div class="post-title"><%= post.title %></div>
          <div class="post-date">
            <%= post.createdAt ? new
            Date(post.createdAt).toLocaleString('ko-KR', { year: 'numeric',
            month: 'long', day: 'numeric' }) : '날짜 없음' %>
          </div>
        </div>
        <% }); %>
      </div>

     <!-- 페이지네이션 -->
     <div class="pagination">
      <% if (totalPages > 1) { %>
        <!-- 이전 페이지 버튼 -->
        <button 
          onclick="location.href='/new?page=<%= currentPage - 1 %>'"
          <%= currentPage === 1 ? 'disabled' : '' %>
        >이전</button>

        <!-- 페이지 번호 버튼들 -->
        <% for(let i = 1; i <= totalPages; i++) { %>
          <button 
            onclick="location.href='/new?page=<%= i %>'"
            class="<%= currentPage === i ? 'active' : '' %>"
          ><%= i %></button>
        <% } %>

        <!-- 다음 페이지 버튼 -->
        <button 
          onclick="location.href='/new?page=<%= currentPage + 1 %>'"
          <%= currentPage === totalPages ? 'disabled' : '' %>
        >다음</button>
      <% } %>
    </div>
    <% if (user) { %>
    <div class="write-btn-container">
      <button onclick="location.href='/new/write'" class="write-btn">
        글쓰기
      </button>
    </div>
    <% } %>
      </div> <!-- container 닫기 -->
    </div> <!-- page-wrapper 닫기 -->

           <footer>
         <div class="footer-content">
           <div class="footer-section">
             <h3>SEONOH</h3>
             <p>매일 성장하는 개발자 되기</p>
           </div>
           <div class="footer-section">
             <h4>Quick Links</h4>
             <ul>
               <li><a href="/new">게시판</a></li>
               <li><a href="/new/write">글쓰기</a></li>
             </ul>
           </div>
           <div class="footer-section">
             <h4>Contact</h4>
             <p>📧 sunfivemin@gmail.com</p>
             <p>💻 <a href="https://github.com/sunfivemin" target="_blank">GitHub</a></p>
           </div>
         </div>
         <div class="footer-bottom">
           <p>© 2025 SEONOH. Made with ❤️ for developers</p>
         </div>
       </footer>

    <script src="/js/search.js" defer></script>
  </body>
</html>
