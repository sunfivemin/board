<!DOCTYPE html>
<html>
  <head>
    <%- include('../partials/head') %>
    <title>로그인</title>
    <link rel="stylesheet" href="/css/main.css" />
    <script src="/js/nav.js" defer></script>
  </head>
  <body>
    <%- include('../partials/nav') %>

    <div class="auth-container">
      <form class="auth-form" action="/auth/login" method="POST" id="loginForm">
        <h4>로그인</h4>

        <% if (error) { %>
        <div class="auth-error show"><%= error %></div>
        <% } %>

        <input
          type="text"
          name="username"
          placeholder="아이디"
          autocomplete="username"
          required
        />
        <input
          type="password"
          name="password"
          placeholder="비밀번호"
          autocomplete="current-password"
          required
        />

        <button type="submit">로그인</button>

        <div class="auth-links">
          계정이 없으신가요? <a href="/auth/signup">회원가입</a>
        </div>
      </form>
    </div>

    <script>
      // URL 파라미터에서 메시지 확인
      const urlParams = new URLSearchParams(window.location.search);
      const message = urlParams.get("message");
      const type = urlParams.get("type");

      if (message) {
        if (type === "success") {
          showModal(message, {
            title: "성공",
            type: "success",
          });
        } else if (type === "error") {
          showModal(message, {
            title: "오류",
            type: "error",
          });
        }
      }

      // 폼 제출 시 로딩 표시
      document
        .getElementById("loginForm")
        .addEventListener("submit", function () {
          const submitBtn = this.querySelector('button[type="submit"]');
          submitBtn.textContent = "로그인 중...";
          submitBtn.disabled = true;
        });
    </script>
  </body>
</html>
